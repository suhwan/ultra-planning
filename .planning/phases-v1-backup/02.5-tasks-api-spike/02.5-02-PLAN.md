---
phase: 02.5-tasks-api-spike
plan: 02
type: execute
wave: 2
depends_on: ["02.5-01"]
files_modified:
  - .planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md
autonomous: true

must_haves:
  truths:
    - "PLAN.md → Claude Tasks 변환 로직이 설계됨"
    - "Claude Tasks → PLAN.md 상태 동기화 로직이 설계됨"
    - "metadata 필드를 통한 원본 위치 추적이 가능함"
  artifacts:
    - path: ".planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md"
      provides: "양방향 동기화 설계"
      contains: "양방향 동기화"
  key_links:
    - from: "PLAN.md task XML"
      to: "Claude Tasks API"
      via: "TaskCreate with metadata"
      pattern: "metadata.planFile"
---

<objective>
PLAN.md와 Claude Tasks 간의 양방향 동기화 PoC를 설계합니다.

Purpose: 실제 동기화 구현 전에 매핑 로직과 데이터 흐름을 검증합니다.

Output: 02.5-RESEARCH.md에 동기화 설계 섹션 추가
</objective>

<context>
@.planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md
@.claude/skills/ultraplan/templates/plan.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: PLAN.md → Claude Tasks 매핑 설계</name>
  <files>.planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md</files>
  <action>
PLAN.md의 XML task 형식을 Claude Tasks로 변환하는 매핑 설계:

1. `<name>` → `subject`
2. `<action>` + `<done>` → `description`
3. Wave 번호 → `metadata.wave`
4. 파일 경로 → `metadata.planFile`, `metadata.taskIndex`
5. `<files>` → `metadata.files`
6. `<verify>` → `metadata.verify`

의존성 매핑:
- Wave 1 tasks: blockedBy = []
- Wave N tasks: blockedBy = [모든 Wave N-1 task IDs]
  </action>
  <verify>
grep "PLAN.md → Claude Tasks" .planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md
  </verify>
  <done>매핑 테이블과 변환 예시가 문서화됨</done>
</task>

<task type="auto">
  <name>Task 2: Claude Tasks → PLAN.md 동기화 설계</name>
  <files>.planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md</files>
  <action>
Claude Tasks 상태 변경을 PLAN.md에 반영하는 로직 설계:

1. TaskUpdate(status: completed) 호출 시
2. metadata.planFile, metadata.taskIndex 읽기
3. 해당 PLAN.md 파일의 task 상태 업데이트
4. 상태 표현 방식 결정 (체크박스 또는 XML 속성)

PLAN.md를 Source of Truth로 유지하는 전략 문서화
  </action>
  <verify>
grep "Claude Tasks → PLAN.md" .planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md
  </verify>
  <done>동기화 프로세스와 Source of Truth 전략 문서화됨</done>
</task>

<task type="auto">
  <name>Task 3: 세션 지속성 해결책 설계</name>
  <files>.planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md</files>
  <action>
Claude Tasks가 세션 종료 시 사라지는 문제 해결책:

1. 세션 시작 시: PLAN.md에서 미완료 태스크 로드
2. 세션 중: Claude Tasks로 진행 관리, 완료 시 PLAN.md 즉시 업데이트
3. 세션 종료 시: PLAN.md에 상태 보존

충돌 처리 전략도 문서화
  </action>
  <verify>
grep "세션 지속성" .planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md
  </verify>
  <done>세션 지속성 해결책과 충돌 처리 전략 문서화됨</done>
</task>

</tasks>

<verification>
1. 매핑 설계: `grep "매핑" .planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md`
2. 동기화 설계: `grep "동기화" .planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md`
3. 세션 전략: `grep "Source of Truth" .planning/phases/02.5-tasks-api-spike/02.5-RESEARCH.md`
</verification>

<success_criteria>
- [x] PLAN.md → Claude Tasks 매핑 테이블 완성
- [x] Claude Tasks → PLAN.md 동기화 프로세스 설계
- [x] 세션 지속성 해결책 문서화
- [x] Source of Truth 전략 명시
</success_criteria>

<output>
완료됨: 02.5-RESEARCH.md 섹션 2, 3, 4
</output>
