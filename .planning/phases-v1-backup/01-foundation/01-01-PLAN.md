---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .ultraplan/config.json
  - .ultraplan/state/.gitkeep
  - .ultraplan/logs/.gitkeep
autonomous: true

must_haves:
  truths:
    - ".ultraplan/ directory exists with correct subdirectories"
    - "config.json contains valid project configuration"
    - "Directory structure is git-trackable"
  artifacts:
    - path: ".ultraplan/config.json"
      provides: "Project configuration schema"
      contains: '"version"'
    - path: ".ultraplan/state/.gitkeep"
      provides: "State directory placeholder"
    - path: ".ultraplan/logs/.gitkeep"
      provides: "Logs directory placeholder"
  key_links: []
---

<objective>
Create the `.ultraplan/` runtime directory structure with configuration schema.

Purpose: Establish the per-project state directory that all other components depend on. This is the foundation that enables state tracking, session persistence, and configuration management.

Output: `.ultraplan/` directory with config.json and subdirectory structure.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md

Key patterns from research:
- `.ultraplan/` mirrors GSD's `.planning/` but uses separate namespace
- JSON for config (machine-readable, no parse ambiguity)
- State/logs as subdirectories for organization
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create directory structure</name>
  <files>
    .ultraplan/
    .ultraplan/state/
    .ultraplan/logs/
  </files>
  <action>
    Create the `.ultraplan/` directory with subdirectories:
    - `.ultraplan/state/` - For session state, continuation files
    - `.ultraplan/logs/` - For execution logs (optional, debug use)

    Add .gitkeep files to state/ and logs/ so empty directories are tracked in git.

    Do NOT create `.ultraplan/plans/` - plans live in the project root or .planning/ structure.
  </action>
  <verify>ls -la .ultraplan/ && ls -la .ultraplan/state/ && ls -la .ultraplan/logs/</verify>
  <done>Three directories exist: .ultraplan/, .ultraplan/state/, .ultraplan/logs/ with .gitkeep files</done>
</task>

<task type="auto">
  <name>Task 2: Create config.json with schema</name>
  <files>.ultraplan/config.json</files>
  <action>
    Create `.ultraplan/config.json` with the following schema:

    ```json
    {
      "version": "1.0.0",
      "mode": "interactive",
      "depth": "standard",
      "parallelization": {
        "enabled": true,
        "max_workers": 5
      },
      "workflow": {
        "auto_verify": true,
        "auto_commit": true,
        "commit_docs": true
      },
      "model_profile": "balanced",
      "created_at": "{ISO timestamp}",
      "project_name": null
    }
    ```

    This config schema defines:
    - version: Schema version for migration support
    - mode: "interactive" (default) or "autopilot"
    - depth: "quick", "standard", or "comprehensive"
    - parallelization: Worker settings matching Phase 7 requirements
    - workflow: Automation toggles
    - model_profile: "speed", "balanced", or "quality"
    - created_at: Initialization timestamp
    - project_name: Set by /ultraplan:new-project

    Use actual ISO timestamp for created_at field.
  </action>
  <verify>cat .ultraplan/config.json | jq .</verify>
  <done>config.json exists with valid JSON, all required fields present, jq parses without error</done>
</task>

</tasks>

<verification>
1. Run: `ls -laR .ultraplan/` - should show config.json, state/, logs/
2. Run: `cat .ultraplan/config.json | jq .` - should parse without error
3. Run: `cat .ultraplan/config.json | jq '.version'` - should return "1.0.0"
4. Verify .gitkeep files exist in state/ and logs/
</verification>

<success_criteria>
- [ ] `.ultraplan/` directory exists in project root
- [ ] `.ultraplan/config.json` contains valid JSON with all schema fields
- [ ] `.ultraplan/state/` directory exists with .gitkeep
- [ ] `.ultraplan/logs/` directory exists with .gitkeep
- [ ] `jq` can parse config.json without errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
