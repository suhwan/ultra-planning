---
phase: 04-omc-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/agents/prompts/architect.ts
  - src/agents/prompts/critic.ts
  - src/agents/types.ts
  - src/agents/index.ts
autonomous: true

must_haves:
  truths:
    - "Architect agent prompt can be retrieved as typed object"
    - "Critic agent prompt can be retrieved as typed object"
    - "Architect is READ-ONLY - no Write/Edit tools in config"
    - "Critic reviews plans, does not create them"
  artifacts:
    - path: "src/agents/prompts/architect.ts"
      provides: "Architect agent prompt definition"
      exports: ["ARCHITECT_PROMPT", "ARCHITECT_CONFIG", "ARCHITECT_SECTIONS", "getArchitectPrompt"]
      min_lines: 100
    - path: "src/agents/prompts/critic.ts"
      provides: "Critic agent prompt definition"
      exports: ["CRITIC_PROMPT", "CRITIC_CONFIG", "CRITIC_SECTIONS", "getCriticPrompt"]
      min_lines: 80
  key_links:
    - from: "src/agents/prompts/architect.ts"
      to: "src/agents/types.ts"
      via: "import AgentPrompt, AgentConfig types"
      pattern: "import.*AgentPrompt"
    - from: "src/agents/prompts/critic.ts"
      to: "src/agents/types.ts"
      via: "import AgentPrompt, AgentConfig types"
      pattern: "import.*AgentPrompt"
    - from: "src/agents/index.ts"
      to: "src/agents/prompts/architect.ts"
      via: "re-export architect"
      pattern: "from.*architect"
---

<objective>
Create Architect and Critic agent prompt modules following the established planner.ts pattern.

Purpose: Ralplan verification loop (Plan 04-04) requires Architect for strategic consultation and Critic for plan review. These agents complete the Planner+Architect+Critic triad.

Output: Two new agent prompt files with typed configurations, structured sections, and getFullPrompt() methods.
</objective>

<execution_context>
@/home/ubuntu/.claude/get-shit-done/workflows/execute-plan.md
@/home/ubuntu/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-omc-integration/04-RESEARCH.md

# Existing agent infrastructure (follow this pattern)
@src/agents/types.ts
@src/agents/prompts/planner.ts

# Reference prompts to adapt
@references/oh-my-claudecode/agents/architect.md
@references/oh-my-claudecode/agents/critic.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Architect Agent Prompt</name>
  <files>src/agents/prompts/architect.ts</files>
  <action>
Create architect.ts following the exact pattern from planner.ts:

1. **ARCHITECT_CONFIG** (AgentConfig):
   - name: 'architect'
   - description: 'Strategic Architecture & Debugging Advisor (READ-ONLY)'
   - role: 'architect'
   - tools: ['Read', 'Grep', 'Glob', 'Bash'] (NO Write, NO Edit - this is critical)
   - suggestedModel: 'opus'
   - color: 'blue'

2. **ARCHITECT_SECTIONS** (AgentPromptSection[]):
   - identity: "YOU ARE A CONSULTANT. YOU DO NOT IMPLEMENT." + FORBIDDEN ACTIONS (Write/Edit BLOCKED)
   - operational_phases: Phase 1 (Context Gathering), Phase 2 (Deep Analysis), Phase 3 (Recommendation Synthesis)
   - anti_patterns: NEVER/ALWAYS lists
   - verification: Iron Law - NO CLAIMS WITHOUT FRESH EVIDENCE
   - debugging_protocol: Root cause analysis, 3-failure circuit breaker

3. **ARCHITECT_PROMPT** (AgentPrompt):
   - config: ARCHITECT_CONFIG
   - sections: ARCHITECT_SECTIONS
   - getFullPrompt(): Compose sections with XML tags

4. **getArchitectPrompt(options?)**: Selective section retrieval

Reference: `references/oh-my-claudecode/agents/architect.md` for content
  </action>
  <verify>npm run build succeeds, ARCHITECT_PROMPT.getFullPrompt() returns string with all sections</verify>
  <done>Architect agent prompt exportable with READ-ONLY constraint clearly stated in identity section</done>
</task>

<task type="auto">
  <name>Task 2: Create Critic Agent Prompt</name>
  <files>src/agents/prompts/critic.ts</files>
  <action>
Create critic.ts following the exact pattern from planner.ts:

1. **CRITIC_CONFIG** (AgentConfig):
   - name: 'critic'
   - description: 'Work plan review expert and critic'
   - role: 'critic'
   - tools: ['Read', 'Glob', 'Grep'] (NO Write - reviews only)
   - suggestedModel: 'opus'
   - color: 'red'

2. **CRITIC_SECTIONS** (AgentPromptSection[]):
   - identity: Work plan review expert, ruthlessly critical mindset
   - evaluation_criteria: Four Core Criteria (Clarity, Verification, Context, Big Picture)
   - review_process: Steps 0-5 with MANDATORY DEEP VERIFICATION
   - verdict_format: [OKAY / REJECT] format with justification

3. **CRITIC_PROMPT** (AgentPrompt):
   - config: CRITIC_CONFIG
   - sections: CRITIC_SECTIONS
   - getFullPrompt(): Compose sections with XML tags

4. **getCriticPrompt(options?)**: Selective section retrieval

Reference: `references/oh-my-claudecode/agents/critic.md` for content
  </action>
  <verify>npm run build succeeds, CRITIC_PROMPT.getFullPrompt() returns string with verdict format</verify>
  <done>Critic agent prompt exportable with OKAY/REJECT verdict format documented</done>
</task>

<task type="auto">
  <name>Task 3: Update Agents Module Exports</name>
  <files>src/agents/index.ts</files>
  <action>
Update agents/index.ts to export new agent prompts:

1. Add imports for architect and critic prompts
2. Re-export all constants: ARCHITECT_PROMPT, ARCHITECT_CONFIG, ARCHITECT_SECTIONS, getArchitectPrompt
3. Re-export all constants: CRITIC_PROMPT, CRITIC_CONFIG, CRITIC_SECTIONS, getCriticPrompt
4. Keep existing planner exports unchanged

Follow existing pattern with type-only exports where appropriate.
  </action>
  <verify>npm run build succeeds, all agent prompts accessible from src/index.ts</verify>
  <done>ARCHITECT_PROMPT and CRITIC_PROMPT accessible via main module exports</done>
</task>

</tasks>

<verification>
```bash
# Build verification
npm run build

# Export verification
node -e "import('./dist/index.js').then(m => {
  console.log('Architect config:', m.ARCHITECT_CONFIG.name);
  console.log('Critic config:', m.CRITIC_CONFIG.name);
  console.log('Architect tools:', m.ARCHITECT_CONFIG.tools);
  console.log('Architect has no Write:', !m.ARCHITECT_CONFIG.tools.includes('Write'));
})"

# Content verification
node -e "import('./dist/index.js').then(m => {
  const arch = m.ARCHITECT_PROMPT.getFullPrompt();
  const crit = m.CRITIC_PROMPT.getFullPrompt();
  console.log('Architect length:', arch.length);
  console.log('Critic length:', crit.length);
  console.log('Architect has CONSULTANT:', arch.includes('CONSULTANT'));
  console.log('Critic has OKAY/REJECT:', crit.includes('OKAY') && crit.includes('REJECT'));
})"
```
</verification>

<success_criteria>
- [ ] npm run build succeeds with no TypeScript errors
- [ ] ARCHITECT_PROMPT.config.tools does NOT include 'Write' or 'Edit'
- [ ] ARCHITECT_PROMPT.getFullPrompt() includes "YOU DO NOT IMPLEMENT"
- [ ] CRITIC_PROMPT.getFullPrompt() includes "OKAY / REJECT" verdict format
- [ ] All exports accessible from src/index.ts
</success_criteria>

<output>
After completion, create `.planning/phases/04-omc-integration/04-01-SUMMARY.md`
</output>
