---
phase: 01-foundation
plan: 05
type: execute
wave: 3
depends_on: ["01-01", "01-02", "01-03"]
files_modified:
  - .claude/skills/ultraplan/SKILL.md
  - .claude/commands/ultraplan-new-project.md
  - .claude/commands/ultraplan-status.md
autonomous: true

must_haves:
  truths:
    - "User can invoke /ultraplan:new-project to initialize a project"
    - "User can invoke /ultraplan:status to see current state"
    - "SKILL.md serves as the main entry point with command reference"
  artifacts:
    - path: ".claude/skills/ultraplan/SKILL.md"
      provides: "Main skill entry point and command reference"
      contains: "## Commands"
    - path: ".claude/commands/ultraplan-new-project.md"
      provides: "Slash command for project initialization"
      contains: "new-project"
    - path: ".claude/commands/ultraplan-status.md"
      provides: "Slash command for status display"
      contains: "status"
  key_links:
    - from: ".claude/commands/ultraplan-new-project.md"
      to: ".claude/skills/ultraplan/templates/project.md"
      via: "Command references template for generation"
      pattern: "templates/project.md"
    - from: ".claude/commands/ultraplan-status.md"
      to: ".ultraplan/config.json"
      via: "Command reads config for status"
      pattern: ".ultraplan/"
---

<objective>
Create the main SKILL.md entry point and CLI command skeletons for /ultraplan:new-project and /ultraplan:status.

Purpose: SKILL.md is the root document that Claude Code loads when the ultraplan skill is invoked. The command skeletons establish the CLI interface that users interact with.

Output: SKILL.md, ultraplan-new-project.md, and ultraplan-status.md command files.
</objective>

<context>
@.planning/PROJECT.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-01-SUMMARY.md
@.planning/phases/01-foundation/01-02-SUMMARY.md
@.planning/phases/01-foundation/01-03-SUMMARY.md

Key patterns from research:
- SKILL.md uses YAML frontmatter for skill metadata
- Commands are in .claude/commands/ directory
- Progressive disclosure: SKILL.md is minimal, references detail docs
- disable-model-invocation: true prevents auto-trigger (explicit only for v1)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create main SKILL.md entry point</name>
  <files>.claude/skills/ultraplan/SKILL.md</files>
  <action>
    Create `.claude/skills/ultraplan/` directory if it does not exist.

    Create `.claude/skills/ultraplan/SKILL.md`:

    ```markdown
    ---
    name: ultraplan
    description: Document-driven workflow orchestration system. Creates PROJECT.md, ROADMAP.md, and PLAN.md with automatic Claude Tasks synchronization. Use /ultraplan:new-project to start, /ultraplan:status to check progress.
    disable-model-invocation: true
    allowed-tools: Read, Write, Bash, Glob, Grep, Task
    ---

    # Ultra Planner

    Document-driven workflow orchestration for Claude Code.

    ## Commands

    | Command | Description |
    |---------|-------------|
    | `/ultraplan:new-project` | Initialize new project with PROJECT.md, ROADMAP.md |
    | `/ultraplan:status` | Show current project state and progress |

    ## Quick Start

    1. Run `/ultraplan:new-project` to initialize
    2. Describe your project when prompted
    3. Review generated PROJECT.md and ROADMAP.md
    4. Run `/ultraplan:status` to see progress

    ## Directory Structure

    ```
    .ultraplan/                 # Runtime state
    ├── config.json             # Project configuration
    ├── state/                  # Session state
    └── logs/                   # Execution logs

    PROJECT.md                  # Project definition
    ROADMAP.md                  # Phase breakdown
    STATE.md                    # Progress tracking
    ```

    ## Configuration

    Edit `.ultraplan/config.json` to customize:

    - `mode`: "interactive" (default) or "autopilot"
    - `depth`: "quick", "standard", or "comprehensive"
    - `parallelization.max_workers`: 1-5 (default 5)

    ## References

    - [Document Templates](templates/) - PROJECT, ROADMAP, PLAN, STATE templates
    - [Schemas](references/schemas.md) - YAML frontmatter and XML task schemas
    - [State Protocol](references/state-protocol.md) - When and how STATE.md updates

    ---
    *Ultra Planner v1.0.0*
    ```

    Note: Use `disable-model-invocation: true` to require explicit /ultraplan:* invocation.
    Phase 6 will add keyword detection for automatic invocation.
  </action>
  <verify>cat .claude/skills/ultraplan/SKILL.md | grep -E "name: ultraplan|## Commands|/ultraplan:"</verify>
  <done>SKILL.md exists with frontmatter (name, description, allowed-tools), Commands section, and reference links</done>
</task>

<task type="auto">
  <name>Task 2: Create command files for new-project and status</name>
  <files>
    .claude/commands/ultraplan-new-project.md
    .claude/commands/ultraplan-status.md
  </files>
  <action>
    Create `.claude/commands/` directory if it does not exist.

    Create `.claude/commands/ultraplan-new-project.md`:

    ```markdown
    ---
    name: ultraplan:new-project
    description: Initialize a new Ultra Planner project. Creates .ultraplan/ directory, PROJECT.md, ROADMAP.md skeleton, and STATE.md. Use when starting a new project or migrating an existing codebase to Ultra Planner.
    disable-model-invocation: true
    allowed-tools: Read, Write, Bash, Glob
    ---

    # /ultraplan:new-project

    Initialize a new Ultra Planner project.

    ## What This Does

    1. Creates `.ultraplan/` directory structure
    2. Creates `config.json` with default settings
    3. Prompts for project description
    4. Generates `PROJECT.md` with requirements structure
    5. Generates `ROADMAP.md` skeleton (phases TBD)
    6. Creates `STATE.md` for progress tracking

    ## Usage

    ```
    /ultraplan:new-project
    ```

    Then describe your project when prompted.

    ## Prerequisites

    - No existing `.ultraplan/` directory (will warn if exists)
    - Write access to project root

    ## Generated Files

    | File | Description |
    |------|-------------|
    | `.ultraplan/config.json` | Project configuration |
    | `PROJECT.md` | Project definition with requirements |
    | `ROADMAP.md` | Phase breakdown (skeleton) |
    | `STATE.md` | Progress tracking |

    ## Templates Used

    - @.claude/skills/ultraplan/templates/project.md
    - @.claude/skills/ultraplan/templates/roadmap.md
    - @.claude/skills/ultraplan/templates/state.md

    ## Next Steps

    After initialization:
    1. Review and edit PROJECT.md requirements
    2. Run `/ultraplan:plan` to generate ROADMAP phases (Phase 2)
    3. Run `/ultraplan:status` to check progress
    ```

    Create `.claude/commands/ultraplan-status.md`:

    ```markdown
    ---
    name: ultraplan:status
    description: Show current Ultra Planner project state including phase progress, current plan, and session continuity information. Use anytime to check where you are in the project.
    disable-model-invocation: true
    allowed-tools: Read, Bash, Glob
    ---

    # /ultraplan:status

    Display current project state and progress.

    ## What This Shows

    1. Current phase and plan
    2. Visual progress bar
    3. Recent activity
    4. Session continuity (where you left off)
    5. Any blockers or pending decisions

    ## Usage

    ```
    /ultraplan:status
    ```

    ## Output Format

    ```
    Ultra Planner Status
    ====================

    Project: {project_name}
    Phase: {N} of {M} ({phase_name})
    Plan: {X} of {Y}

    Progress: [####░░░░░░░░░░░░░░░░] 20%

    Last Activity: {date} - {description}

    Session: {status}
    Resume: {continue_file_or_none}

    Blockers: {count}
    Pending: {decisions_count}
    ```

    ## Data Sources

    - `.ultraplan/config.json` - Project name, settings
    - `STATE.md` - Progress, session continuity
    - `ROADMAP.md` - Phase count, current phase details

    ## Error Conditions

    | Condition | Message |
    |-----------|---------|
    | No .ultraplan/ | "Not an Ultra Planner project. Run /ultraplan:new-project first." |
    | No STATE.md | "STATE.md not found. Project may be corrupted." |
    | Stale state | "Warning: STATE.md may be out of sync with filesystem." |
    ```
  </action>
  <verify>ls -la .claude/commands/ultraplan-*.md && grep "name: ultraplan:" .claude/commands/ultraplan-*.md</verify>
  <done>Both command files exist with proper frontmatter (name, description, allowed-tools) and usage documentation</done>
</task>

</tasks>

<verification>
1. SKILL.md exists: `ls .claude/skills/ultraplan/SKILL.md`
2. Command files exist: `ls .claude/commands/ultraplan-*.md`
3. SKILL.md has frontmatter: `head -10 .claude/skills/ultraplan/SKILL.md`
4. new-project references templates: `grep "templates/" .claude/commands/ultraplan-new-project.md`
5. status references config: `grep ".ultraplan/" .claude/commands/ultraplan-status.md`
</verification>

<success_criteria>
- [ ] `.claude/skills/ultraplan/SKILL.md` exists with valid frontmatter
- [ ] SKILL.md has Commands section listing /ultraplan:new-project and /ultraplan:status
- [ ] `.claude/commands/ultraplan-new-project.md` exists with frontmatter
- [ ] new-project command references templates directory
- [ ] `.claude/commands/ultraplan-status.md` exists with frontmatter
- [ ] status command references STATE.md and config.json data sources
- [ ] All commands have `disable-model-invocation: true` (explicit invocation only)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-05-SUMMARY.md`
</output>
