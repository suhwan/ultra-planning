---
phase: 03-gsd-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/documents/types.ts
  - src/documents/validation/schemas.ts
  - src/documents/templates/project.ts
  - src/documents/templates/roadmap.ts
  - src/documents/templates/plan.ts
  - src/documents/index.ts
autonomous: true

must_haves:
  truths:
    - "PROJECT.md can be generated from ProjectConfig input"
    - "ROADMAP.md can be generated from RoadmapConfig input"
    - "PLAN.md can be generated from PlanDocument input with frontmatter"
    - "Generated documents match GSD template structure"
  artifacts:
    - path: "src/documents/types.ts"
      provides: "Document configuration types"
      exports: ["ProjectConfig", "RoadmapConfig", "PhaseConfig", "PlanDocument"]
      min_lines: 80
    - path: "src/documents/validation/schemas.ts"
      provides: "Zod schemas for frontmatter validation"
      exports: ["PlanFrontmatterSchema", "MustHavesSchema"]
      min_lines: 50
    - path: "src/documents/templates/project.ts"
      provides: "PROJECT.md generator"
      exports: ["generateProjectMd"]
      min_lines: 60
    - path: "src/documents/templates/roadmap.ts"
      provides: "ROADMAP.md generator"
      exports: ["generateRoadmapMd"]
      min_lines: 80
    - path: "src/documents/templates/plan.ts"
      provides: "PLAN.md generator"
      exports: ["generatePlanMd", "parsePlanMd"]
      min_lines: 100
  key_links:
    - from: "src/documents/templates/plan.ts"
      to: "src/documents/validation/schemas.ts"
      via: "import for frontmatter validation"
      pattern: "import.*schemas"
    - from: "src/documents/index.ts"
      to: "src/documents/templates/*.ts"
      via: "re-exports all generators"
---

<objective>
Implement document template generators for PROJECT.md, ROADMAP.md, and PLAN.md.

Purpose: Enable automatic generation of GSD planning documents from structured TypeScript inputs, establishing the document generation foundation.
Output: Pure functions that accept typed configs and produce markdown strings matching GSD template structure.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Source types (existing from Phase 1-2)
@src/types.ts

# Reference templates (GSD originals)
@references/get-shit-done/get-shit-done/templates/project.md
@references/get-shit-done/get-shit-done/templates/roadmap.md
@references/get-shit-done/get-shit-done/templates/phase-prompt.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create document types and Zod schemas</name>
  <files>src/documents/types.ts, src/documents/validation/schemas.ts</files>
  <action>
Create src/documents/types.ts with configuration interfaces:
- ProjectConfig: name, description, coreValue, requirements (active[], outOfScope[]), context, constraints[], keyDecisions[]
- RoadmapConfig: projectName, overview, phases[], milestones[] (optional)
- PhaseConfig: number, name, goal, dependsOn, requirements[], successCriteria[], plans[]
- PlanDocument: frontmatter (PlanFrontmatter from src/types.ts), content (string)

Create src/documents/validation/schemas.ts with Zod schemas:
- Re-export enhanced PlanFrontmatterSchema with full must_haves validation
- ArtifactSchema, KeyLinkSchema, MustHavesSchema (detailed validation)
- ValidatedPlanFrontmatter type inference

Use existing PlanFrontmatter from src/types.ts as base. Zod schemas provide runtime validation.
Directory structure: src/documents/validation/ (create if needed).
  </action>
  <verify>npx tsc --noEmit src/documents/types.ts src/documents/validation/schemas.ts</verify>
  <done>Types compile, schemas export validation functions, can validate plan frontmatter</done>
</task>

<task type="auto">
  <name>Task 2: Implement document template generators</name>
  <files>src/documents/templates/project.ts, src/documents/templates/roadmap.ts, src/documents/templates/plan.ts</files>
  <action>
Create src/documents/templates/project.ts:
- generateProjectMd(config: ProjectConfig): string
- Output matches GSD template structure: What This Is, Core Value, Requirements (Validated/Active/Out of Scope), Context, Constraints, Key Decisions
- Include "Last updated" footer with ISO date

Create src/documents/templates/roadmap.ts:
- generateRoadmapMd(config: RoadmapConfig): string
- Output: Overview, Phases checklist, Phase Details (Goal, Depends on, Requirements, Success Criteria, Plans), Progress table
- Support decimal phase numbering (2.1, 2.2)

Create src/documents/templates/plan.ts:
- generatePlanMd(doc: PlanDocument): string - combines frontmatter + content using gray-matter
- parsePlanMd(markdown: string): PlanDocument - extracts frontmatter + content
- Install gray-matter: npm install gray-matter && npm install -D @types/gray-matter

All generators: Pure functions, no side effects, template literal strings with proper escaping.
  </action>
  <verify>npx tsc --noEmit src/documents/templates/*.ts && npm test -- --grep "document"</verify>
  <done>All three generators compile, produce valid markdown, parse/generate round-trip works for PLAN.md</done>
</task>

<task type="auto">
  <name>Task 3: Create module index and integrate with main exports</name>
  <files>src/documents/index.ts, src/index.ts</files>
  <action>
Create src/documents/index.ts:
- Re-export all types from ./types.ts
- Re-export all schemas from ./validation/schemas.ts
- Re-export all generators from ./templates/*.ts

Update src/index.ts:
- Add: export * from './documents/index.js';

Ensure all exports use .js extension for ESM compatibility (matching existing pattern in src/index.ts).
  </action>
  <verify>npx tsc --noEmit && node --loader ts-node/esm -e "import { generateProjectMd } from './src/index.js'"</verify>
  <done>Documents module exports accessible from main entry point, tree-shakeable</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds
- [ ] `npx tsc --noEmit` passes for all new files
- [ ] All exports accessible from src/index.ts
- [ ] gray-matter installed and types available
</verification>

<success_criteria>
- All tasks completed
- Document generators produce markdown matching GSD template structure
- Zod schemas validate plan frontmatter correctly
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-gsd-integration/03-01-SUMMARY.md`
</output>
